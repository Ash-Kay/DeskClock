# Smart Desk Clock - Project Documentation

## Project Overview

ESP32-based smart desk clock with air quality monitoring, LED matrix display, and web-based controls. Features include Pomodoro timer, time/date display, custom text scrolling, and environmental monitoring.

## Hardware Components

### Core Components

1. **ESP32-WROOM-32** - Main microcontroller
   - WiFi enabled
   - Dual-core processor
   - GPIO pins for sensor/display connections
   - Powers the entire system

2. **MAX7219 LED Dot Matrix Display**
   - 4 modules configuration (32x8 pixels)
   - SPI communication
   - Pin connections:
     - CLK_PIN: 18
     - DATA_PIN: 23
     - CS_PIN: 5
   - Hardware type: FC16_HW
   - Used for time, date, messages, and Pomodoro timer display

3. **PLANTOWER PMSA003-A Air Quality Sensor**
   - PM1.0, PM2.5, PM10 particle measurement
   - UART communication
   - Provides real-time air quality data
   - Integration planned for environmental monitoring

### Additional Components

4. **Power Supply** - 5V DC adapter or USB power
5. **Breadboard/PCB** - For component connections
6. **Jumper Wires** - For GPIO connections
7. **Housing/Enclosure** - Desktop mounting case

## Current Features

### Display Modes

- **Clock Mode**: Shows current time (12/24hr format with PM indicator)
- **Date Display**: Scrolls date information every minute
- **Pomodoro Timer**: Visual countdown with progress border
- **Custom Text**: User-defined scrolling messages

### Web Interface

- WiFi-based control panel
- Pomodoro timer controls (25min focus, 5min break)
- Time zone and format settings
- Custom message input
- Responsive mobile-friendly design

### Display Features

- Custom 3x5 pixel tiny font for Pomodoro timer
- Animated border progress indicator
- Auto-brightness control (intensity level 1)
- Text scrolling animations
- 180-degree display rotation handling

## Network Configuration

- SSID: ACT102677324080
- WiFi server on port 80
- NTP time synchronization (pool.ntp.org)
- Default timezone: +5.5 (IST)

## Pin Assignments

```
MAX7219 LED Matrix:
- CLK (Clock): GPIO 18
- DIN (Data): GPIO 23
- CS (Chip Select): GPIO 5

PMSA003-A (Planned):
- TX: GPIO 16
- RX: GPIO 17
- Power: 5V, GND
```

## Libraries Used

- WiFi.h - ESP32 WiFi connectivity
- MD_Parola.h - LED matrix text display
- MD_MAX72XX.h - MAX7219 driver
- SPI.h - Serial communication
- time.h - NTP time functions
- vector - STL container for module management

## File Structure

```
main.ino           - Main program with setup/loop
config.h           - WiFi credentials (git-ignored)
config.h.example   - Template for configuration
Module.h           - Base class for all modules
ModuleManager.h    - Module lifecycle and web integration
ClockModule.h      - Time/date display functionality
PomodoroModule.h   - Timer with visual progress
TextModule.h       - Custom message scrolling
.copilot.md        - Project documentation
.gitignore         - Security and build exclusions
```

## Future Enhancements

- [ ] PMSA003-A sensor integration
- [ ] Air quality display on LED matrix
- [ ] Temperature/humidity sensor
- [ ] Weather data integration
- [ ] Sleep mode and wake scheduling
- [ ] Mobile app integration
- [ ] Data logging and analytics

## Code Architecture

### Modular System

The project uses a **plug-and-play modular architecture** for easy extensibility:

- **Module Base Class**: Abstract interface for all features
- **ModuleManager**: Handles module lifecycle, switching, and web integration
- **Auto-switching**: Returns to default module (Clock) after temporary modules finish

### Available Modules

1. **ClockModule** (Default/Persistent)
   - Time display with 12/24hr formats
   - Timezone configuration
   - Automatic date scrolling
   - PM indicator for 12hr mode

2. **PomodoroModule**
   - Customizable timer durations
   - Visual countdown with border progress
   - Custom tiny font rendering
   - Auto-deactivates on completion

3. **TextModule**
   - Custom message scrolling
   - Configurable scroll speeds
   - URL-decoded text input
   - Auto-deactivates after scroll

### Module Structure

```cpp
class YourModule : public Module {
public:
    void init() override;           // Initialize module
    void activate() override;       // Called when module becomes active
    void deactivate() override;     // Called when switching away
    void update() override;         // Called every loop iteration
    const char* getName() override; // Module identifier
    const char* getWebControls() override; // HTML controls
    bool handleWebRequest(String) override; // Handle web requests
};
```

### Adding New Modules

1. Create new module class inheriting from `Module`
2. Implement required virtual methods
3. Add to ModuleManager in `setup()`: `moduleManager.addModule(new YourModule())`
4. Module automatically appears in web interface

## Development Notes

- Display uses custom font rendering for compact time display
- Border progress animation calculated via perimeter LEDs
- 180-degree rotation handled in drawing functions
- Text animations use MD_Parola library effects
- Time updates every 1 second, date scrolls every minute

## Usage Instructions

1. Power on device
2. Connect to WiFi network
3. Access web interface via ESP32's IP address
4. Use controls to set time format, start timers, or send messages
5. Monitor air quality data (when sensor integrated)
